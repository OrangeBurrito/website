---
import BaseLayout from '../layouts/BaseLayout.astro'


export function getStaticPaths({paginate}) {
	const allPosts = Astro.fetchContent('./posts/*.md')
	const sortedPosts = allPosts.sort((a, b) => new Date(b.publishedDate).valueOf() - new Date(a.publishedDate).valueOf());
  return paginate(sortedPosts, {pageSize: 5});
}

const {page} = Astro.props
---

<BaseLayout title="OrangeBurrito">
<div class="post-list">
<h1 class="posts-header">The Sacred Texts</h1>
{page.data.map((post) => (
	<a class="post" href={post.url}>
		<img class="post-icon" src={post.coverImage}/>
		<div class="text-block">
			<h2 class="post-title">{post.title}</h2>
			<p>{post.description}</p>
			<div class="date">
				<time datetime={post.publishedDate}>{post.publishedDate}</time>
				<img class="date-icon" src="/images/clock_icon.png" alt="">
			</div>
		</div>
	</a>
))}
</div>
</BaseLayout>

<style>
	.posts-header {
		position: relative;
		display: inline-block;
		font-weight: normal;
		font-size: clamp(var(--pd15), 4vw, var(--pd2));
		color: var(--accent);
		margin-bottom: clamp(var(--pd2), 4vw, var(--pd3));
	}

	.posts-header::after {
		position: absolute;
		right: 0;
		top: var(--pd025);
		content: '____';
		color: rgba(0,0,0,0);
		border-bottom: 3.5px solid var(--accent);
	}

	.post {
		position: relative;
		display: inline-flex;
		flex-wrap: wrap;
		justify-content: flex-end;
		gap: var(--pd1);
		margin-bottom: clamp(var(--pd15), 4vw, var(--pd25));
		transition: 0.08s ease-in;
	}

	.post:hover {
		padding: 0 var(--pd15) var(--pd15) 0;
		border-right: 4px solid var(--accent);
		border-bottom: 4px solid var(--accent);
		margin-bottom: var(--pd05);
	}

	.post:hover .post-title {
		color: var(--accent);
	}

	.post-title, .post p {
		filter: drop-shadow(-2px 2px var(--black));
	}
	
	.post p {
		color: var(--text-shade);
		font-size: clamp(var(--pd125), 4vw, var(--pd175));
	}

	.post-icon {
		width: 70px;
	}

	@media screen and (max-width: 600px) {
		.posts-header::after {
			border-bottom: 2.5px solid var(--accent);
		}

		.post-icon {
			position: absolute;
			left: 0;
			z-index: -1;
		}
	}
</style>